{% extends "base.html" %}
{% block title %}tracekit Dashboard{% endblock %}

{% block body %}
<div class="container">
    <h1>üèÉ‚Äç‚ôÇÔ∏è tracekit</h1>

    {% include 'partials/_nav.html' %}

    <div class="section">
        <h2>üóì Current Config</h2>
        <div class="config-item">
            <span class="config-key">Timezone</span>
            <span class="config-value">{{ config.home_timezone or '‚Äî' }}</span>
        </div>
        <div class="config-item">
            <span class="config-key">Debug</span>
            <span class="config-value">{{ 'on' if config.debug else 'off' }}</span>
        </div>
        <div class="config-item">
            <span class="config-key">Providers enabled</span>
            <span class="config-value">
                {%- set enabled = namespace(names=[]) -%}
                {%- for name, p in (config.providers or {}).items() -%}
                    {%- if p.enabled -%}{%- set enabled.names = enabled.names + [name] -%}{%- endif -%}
                {%- endfor -%}
                {{ enabled.names | join(', ') or '(none)' }}
            </span>
        </div>
        <div style="margin-top:14px">
            <a href="/settings" class="nav-link sm">Edit in Settings ‚Üí</a>
        </div>
    </div>

    {% if db_info %}
    <div class="section{% if db_info.error %} error{% endif %}">
        <h2>üíæ Database</h2>
        {% if db_info.error %}
            <p><strong>Error:</strong> {{ db_info.error }}</p>
        {% else %}
            <div class="config-item">
                <span class="config-key">Total tables</span>
                <span class="config-value">{{ db_info.total_tables }}</span>
            </div>
            {% if db_info.tables %}
            <div class="table-grid">
                {% for table_name, row_count in db_info.tables.items() %}
                <div class="table-item">
                    <div class="table-name">{{ table_name }}</div>
                    <div class="table-count">{{ row_count }} rows</div>
                </div>
                {% endfor %}
            </div>
            {% endif %}
        {% endif %}
    </div>
    {% endif %}
</div>
{% endblock %}
