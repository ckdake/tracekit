{% extends "base.html" %}
{% block title %}tracekit{% endblock %}

{% block body %}
<div class="container-wide">
    <div class="calendar-grid" id="calendar-grid">
        {% for month in initial_months %}
        <div class="month-card {% if month.year_month == current_month %}current{% endif %}"
             id="card-{{ month.year_month }}">
            <div class="month-header">
                <div class="month-title-row">
                    <span>{{ month.month_name }} {{ month.year }}</span>
                    <button class="pull-btn" data-month="{{ month.year_month }}"
                            onclick="pullMonth(this)" title="Pull">⬇</button>
                </div>
                <div class="total-label" id="total-{{ month.year_month }}"></div>
            </div>
            <div class="provider-grid" id="grid-{{ month.year_month }}">
                <div class="card-loading">Loading…</div>
            </div>
            <div class="pull-status" id="status-{{ month.year_month }}"></div>
        </div>
        {% endfor %}
    </div>

    <div class="load-more-bar">
        <button class="btn-load-more" id="load-more-btn" onclick="loadMoreMonths()">Load 12 more months</button>
    </div>
</div>

<script>
const PROVIDER_CONFIG = {{ (config.providers or {})|tojson }};
const INITIAL_OLDEST  = {{ (initial_months[-1].year_month if initial_months else '')|tojson }};
</script>
<script src="{{ url_for('static', filename='calendar.js') }}"></script>
{% endblock %}
