{# Shared app header — included by base.html. Expects optional `page_name` context var. #}
<header class="app-header">
    <a href="/" class="header-brand">
        <img src="{{ url_for('static', filename='logo.png') }}" alt="tracekit" class="header-logo">
        <span class="header-name">tracekit</span>
    </a>
    {% if page_name %}
    <div class="header-breadcrumb">
        <span class="breadcrumb-sep">/</span>
        <span class="breadcrumb-active">{{ page_name }}</span>
    </div>
    {% endif %}
    <div class="header-actions">
        {% if single_user_mode or current_user %}
        <div class="header-recent">
            <span class="recent-label">last activity</span>
            <span class="recent-value" id="recent-activity-time">—</span>
        </div>
        <div class="notif-wrap" id="notif-wrap">
            <button class="notif-bell" id="notif-bell" aria-label="Notifications" title="Notifications">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true"><path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"/><path d="M13.73 21a2 2 0 0 1-3.46 0"/></svg>
                <span class="notif-badge" id="notif-badge" hidden>0</span>
            </button>
            <div class="notif-dropdown" id="notif-dropdown" hidden>
                <div class="notif-dropdown-header">
                    <span class="notif-dropdown-title">Notifications</span>
                    <button class="notif-read-all" id="notif-read-all">Mark all read</button>
                </div>
                <ul class="notif-list" id="notif-list">
                    <li class="notif-empty">No notifications</li>
                </ul>
            </div>
        </div>
        {% if current_user and current_user.is_admin %}
        <a href="/admin" class="notif-bell{% if page_name == 'Admin' %} active{% endif %}" aria-label="Admin" title="Admin">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/></svg>
        </a>
        {% endif %}
        <a href="/settings" class="notif-bell{% if page_name == 'Settings' %} active{% endif %}" aria-label="Settings" title="Settings">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true"><circle cx="12" cy="12" r="3"/><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1-2.83 2.83l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-4 0v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83-2.83l.06-.06A1.65 1.65 0 0 0 4.68 15a1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1 0-4h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 2.83-2.83l.06.06A1.65 1.65 0 0 0 9 4.68a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 4 0v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 2.83l-.06.06A1.65 1.65 0 0 0 19.4 9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 0 4h-.09a1.65 1.65 0 0 0-1.51 1z"/></svg>
        </a>
        {% endif %}
        {% if not single_user_mode %}
        {% if current_user %}
        <span class="header-user-email" title="{{ current_user.email }}">{{ current_user.email }}</span>
        <form method="post" action="/logout" class="header-logout-form">
            <button type="submit" class="notif-bell" aria-label="Log out" title="Log out ({{ current_user.email }})">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true"><path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"/><polyline points="16 17 21 12 16 7"/><line x1="21" y1="12" x2="9" y2="12"/></svg>
            </button>
        </form>
        {% else %}
        <a href="/login" class="notif-bell{% if page_name == 'Log In' %} active{% endif %}" aria-label="Log in" title="Log in">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true"><path d="M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4"/><polyline points="10 17 15 12 10 7"/><line x1="15" y1="12" x2="3" y2="12"/></svg>
        </a>
        <a href="/signup" class="notif-bell{% if page_name == 'Sign Up' %} active{% endif %}" aria-label="Sign up" title="Sign up">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/><line x1="19" y1="8" x2="19" y2="14"/><line x1="22" y1="11" x2="16" y2="11"/></svg>
        </a>
        {% endif %}
        {% endif %}
    </div>
</header>
